<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muletown Law - Document Generator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function UnifiedDocumentGenerator() {
            const [formData, setFormData] = useState({
                // Client Information
                CLIENT_NAME: '',
                CLIENT_GENDER: 'Female',
                CLIENT_COUNTY: 'Maury',
                IS_COUPLE: false,
                SPOUSE_NAME: '',
                SPOUSE_GENDER: 'Male',

                // Execution Date
                EXEC_MONTH: 'October',
                EXEC_YEAR: new Date().getFullYear().toString(),

                // Children (for will)
                children: [],

                // Fiduciary/Agent (same person for Executor, AIF, Primary Agent)
                FIDUCIARY_NAME: '',
                FIDUCIARY_RELATIONSHIP: 'spouse',
                FIDUCIARY_COUNTY: 'Maury',

                // Alternate Fiduciary
                ALTERNATE_FIDUCIARY_NAME: '',
                ALTERNATE_FIDUCIARY_RELATIONSHIP: 'child',
                ALTERNATE_FIDUCIARY_COUNTY: 'Maury',

                // Will-specific
                CONTINGENT_BENEFICIARY_NAME: '',
                CONTINGENT_BENEFICIARY_RELATION: '',
                TRUSTEE_NAME: '',

                // Optional Will Clauses
                INCLUDE_DISINHERITANCE: false,
                DISINHERITED_NAME: '',
                DISINHERITED_RELATION: '',
                INCLUDE_HANDWRITTEN_LIST: false,
                INCLUDE_REAL_ESTATE_DEBT: false,
                INCLUDE_NO_CONTEST: false,

                // For spouse documents
                SPOUSE_AGENTS_RECIPROCAL: true
            });

            const [selectedDocs, setSelectedDocs] = useState({
                will: false,
                poa: false,
                hcpoa: false,
                acp: false
            });

            const [generating, setGenerating] = useState(false);
            const [progress, setProgress] = useState({ current: 0, total: 0, message: '' });
            const [completed, setCompleted] = useState(false);
            const [generatedDocs, setGeneratedDocs] = useState([]);

            const tennesseeCounties = ["Anderson", "Bedford", "Benton", "Bledsoe", "Blount", "Bradley", "Campbell", "Cannon", "Carroll", "Carter", "Cheatham", "Chester", "Claiborne", "Clay", "Cocke", "Coffee", "Crockett", "Cumberland", "Davidson", "Decatur", "DeKalb", "Dickson", "Dyer", "Fayette", "Fentress", "Franklin", "Gibson", "Giles", "Grainger", "Greene", "Grundy", "Hamblen", "Hamilton", "Hancock", "Hardeman", "Hardin", "Hawkins", "Haywood", "Henderson", "Henry", "Hickman", "Houston", "Humphreys", "Jackson", "Jefferson", "Johnson", "Knox", "Lake", "Lauderdale", "Lawrence", "Lewis", "Lincoln", "Loudon", "McMinn", "McNairy", "Macon", "Madison", "Marion", "Marshall", "Maury", "Meigs", "Monroe", "Montgomery", "Moore", "Morgan", "Obion", "Overton", "Perry", "Pickett", "Polk", "Putnam", "Rhea", "Roane", "Robertson", "Rutherford", "Scott", "Sequatchie", "Sevier", "Shelby", "Smith", "Stewart", "Sullivan", "Sumner", "Tipton", "Trousdale", "Unicoi", "Union", "Van Buren", "Warren", "Washington", "Wayne", "Weakley", "White", "Williamson", "Wilson"];

            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

            const handleChange = (e) => {
                const { name, value, type, checked } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: type === 'checkbox' ? checked : value
                }));
            };

            const handleDocSelection = (doc) => {
                setSelectedDocs(prev => ({
                    ...prev,
                    [doc]: !prev[doc]
                }));
            };

            const addChild = () => {
                setFormData(prev => ({
                    ...prev,
                    children: [...prev.children, { name: '', dob: '' }]
                }));
            };

            const removeChild = (index) => {
                setFormData(prev => ({
                    ...prev,
                    children: prev.children.filter((_, i) => i !== index)
                }));
            };

            const updateChild = (index, field, value) => {
                setFormData(prev => ({
                    ...prev,
                    children: prev.children.map((child, i) =>
                        i === index ? { ...child, [field]: value } : child
                    )
                }));
            };

            // Auto-populate trustee with fiduciary if empty
            useEffect(() => {
                if (formData.FIDUCIARY_NAME && !formData.TRUSTEE_NAME) {
                    setFormData(prev => ({
                        ...prev,
                        TRUSTEE_NAME: prev.FIDUCIARY_NAME
                    }));
                }
            }, [formData.FIDUCIARY_NAME]);

            const generateDocument = async (docType, clientName, clientGender, clientCounty, data) => {
                const endpoints = {
                    will: '/api/generate-will',
                    poa: '/api/generate-poa',
                    hcpoa: '/api/generate-hcpoa',
                    acp: '/api/generate-acp'
                };

                // Map unified form data to document-specific variable names
                let requestData = {};

                if (docType === 'will') {
                    // Infer marriage status from relationship
                    const isMarried = data.IS_COUPLE || data.FIDUCIARY_RELATIONSHIP === 'spouse';
                    const spouseName = data.IS_COUPLE ? data.SPOUSE_NAME :
                                     (data.FIDUCIARY_RELATIONSHIP === 'spouse' ? data.FIDUCIARY_NAME : '');
                    const spouseGender = data.IS_COUPLE ? data.SPOUSE_GENDER :
                                        (data.FIDUCIARY_RELATIONSHIP === 'spouse' ?
                                         (clientGender === 'Male' ? 'Female' : 'Male') : '');

                    requestData = {
                        CLIENT_NAME: clientName,
                        CLIENT_GENDER: clientGender,
                        COUNTY: clientCounty,
                        IS_MARRIED: isMarried,
                        SPOUSE_NAME: spouseName,
                        SPOUSE_GENDER: spouseGender,
                        children: JSON.stringify(data.children),
                        PRIMARY_EXECUTOR: data.FIDUCIARY_NAME,
                        ALTERNATE_EXECUTOR: data.ALTERNATE_FIDUCIARY_NAME,
                        ALTERNATE_EXECUTOR_RELATION: data.ALTERNATE_FIDUCIARY_RELATIONSHIP,
                        ALTERNATE_EXECUTOR_COUNTY: data.ALTERNATE_FIDUCIARY_COUNTY,
                        ALTERNATE_EXECUTOR_STATE: 'Tennessee',
                        CONTINGENT_BENEFICIARY_NAME: data.CONTINGENT_BENEFICIARY_NAME || '',
                        CONTINGENT_BENEFICIARY_RELATION: data.CONTINGENT_BENEFICIARY_RELATION || '',
                        TRUSTEE_NAME: data.TRUSTEE_NAME || data.FIDUCIARY_NAME,
                        EXECUTION_MONTH: data.EXEC_MONTH,
                        EXECUTION_YEAR: data.EXEC_YEAR,
                        INCLUDE_DISINHERITANCE: data.INCLUDE_DISINHERITANCE,
                        DISINHERITED_NAME: data.DISINHERITED_NAME,
                        DISINHERITED_RELATION: data.DISINHERITED_RELATION,
                        INCLUDE_HANDWRITTEN_LIST: data.INCLUDE_HANDWRITTEN_LIST,
                        INCLUDE_REAL_ESTATE_DEBT: data.INCLUDE_REAL_ESTATE_DEBT,
                        INCLUDE_NO_CONTEST: data.INCLUDE_NO_CONTEST
                    };
                } else if (docType === 'poa') {
                    requestData = {
                        CLIENT_NAME: clientName,
                        CLIENT_GENDER: clientGender,
                        COUNTY: clientCounty,
                        AIF_NAME: data.FIDUCIARY_NAME,
                        AIF_RELATIONSHIP: data.FIDUCIARY_RELATIONSHIP,
                        ALTERNATE_AIF_NAME: data.ALTERNATE_FIDUCIARY_NAME,
                        ALTERNATE_AIF_RELATIONSHIP: data.ALTERNATE_FIDUCIARY_RELATIONSHIP,
                        EXEC_MONTH: data.EXEC_MONTH,
                        EXEC_YEAR: data.EXEC_YEAR
                    };
                } else if (docType === 'hcpoa' || docType === 'acp') {
                    requestData = {
                        CLIENT_NAME: clientName,
                        CLIENT_GENDER: clientGender,
                        CLIENT_COUNTY: clientCounty,
                        CLIENT_PRONOUN: clientGender === 'Male' ? 'he' : 'she',
                        PRIMARY_AGENT_NAME: data.FIDUCIARY_NAME,
                        PRIMARY_AGENT_RELATION: data.FIDUCIARY_RELATIONSHIP,
                        PRIMARY_AGENT_COUNTY: data.FIDUCIARY_COUNTY,
                        ALTERNATE_AGENT_NAME: data.ALTERNATE_FIDUCIARY_NAME,
                        ALTERNATE_AGENT_RELATION: data.ALTERNATE_FIDUCIARY_RELATIONSHIP,
                        ALTERNATE_AGENT_COUNTY: data.ALTERNATE_FIDUCIARY_COUNTY,
                        EXEC_MONTH: data.EXEC_MONTH,
                        EXEC_YEAR: data.EXEC_YEAR
                    };
                }

                const response = await fetch(endpoints[docType], {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestData)
                });

                if (response.ok) {
                    const blob = await response.blob();

                    // Extract filename from Content-Disposition header
                    const contentDisposition = response.headers.get('Content-Disposition');
                    let filename = `${docType.toUpperCase()}_${clientName.replace(/ /g, '_')}.docx`; // fallback
                    if (contentDisposition) {
                        const matches = /filename="([^"]+)"/.exec(contentDisposition) || /filename=([^;]+)/.exec(contentDisposition);
                        if (matches && matches[1]) {
                            filename = matches[1];
                        }
                    }

                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    return true;
                }
                return false;
            };

            const handleGenerateAll = async () => {
                const docsToGenerate = Object.keys(selectedDocs).filter(doc => selectedDocs[doc]);

                if (docsToGenerate.length === 0) {
                    alert('Please select at least one document type');
                    return;
                }

                if (!formData.CLIENT_NAME) {
                    alert('Please enter client name');
                    return;
                }

                if (!formData.FIDUCIARY_NAME) {
                    alert('Please enter executor/agent name');
                    return;
                }

                if (formData.IS_COUPLE && !formData.SPOUSE_NAME) {
                    alert('Please enter spouse name');
                    return;
                }

                setGenerating(true);
                setGeneratedDocs([]);

                const clients = [{ name: formData.CLIENT_NAME, gender: formData.CLIENT_GENDER }];
                if (formData.IS_COUPLE) {
                    clients.push({ name: formData.SPOUSE_NAME, gender: formData.SPOUSE_GENDER });
                }

                const totalDocs = docsToGenerate.length * clients.length;
                let current = 0;

                for (const client of clients) {
                    for (const docType of docsToGenerate) {
                        current++;
                        setProgress({
                            current,
                            total: totalDocs,
                            message: `Generating ${docType.toUpperCase()} for ${client.name}...`
                        });

                        // For spouse, use reciprocal agents if selected
                        let docData = { ...formData };
                        if (client.name === formData.SPOUSE_NAME && formData.SPOUSE_AGENTS_RECIPROCAL) {
                            docData = {
                                ...formData,
                                FIDUCIARY_NAME: formData.CLIENT_NAME,
                                FIDUCIARY_RELATIONSHIP: 'spouse',
                                FIDUCIARY_COUNTY: formData.CLIENT_COUNTY,
                                SPOUSE_NAME: formData.CLIENT_NAME,
                                SPOUSE_GENDER: formData.CLIENT_GENDER
                            };
                        }

                        const success = await generateDocument(
                            docType,
                            client.name,
                            client.gender,
                            formData.CLIENT_COUNTY,
                            docData
                        );

                        if (success) {
                            setGeneratedDocs(prev => [...prev, `${docType.toUpperCase()} - ${client.name}`]);
                        }

                        // Small delay between documents
                        await new Promise(resolve => setTimeout(resolve, 500));
                    }
                }

                setGenerating(false);
                setCompleted(true);
            };

            const reset = () => {
                setCompleted(false);
                setGeneratedDocs([]);
                setProgress({ current: 0, total: 0, message: '' });
            };

            if (completed) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-green-600 to-blue-700 py-12 px-4 flex items-center justify-center">
                        <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-8 text-center">
                            <div className="text-6xl mb-4">✅</div>
                            <h1 className="text-4xl font-bold text-gray-900 mb-4">All Documents Generated!</h1>
                            <p className="text-gray-600 mb-6">
                                Successfully generated {generatedDocs.length} document{generatedDocs.length !== 1 ? 's' : ''}
                            </p>

                            <div className="bg-gray-50 rounded-lg p-6 mb-6 max-h-96 overflow-y-auto">
                                <h2 className="font-semibold mb-2">Documents Created:</h2>
                                <ul className="text-left space-y-1">
                                    {generatedDocs.map((doc, idx) => (
                                        <li key={idx} className="flex items-center text-sm">
                                            <span className="text-green-600 mr-2">✓</span>
                                            {doc}
                                        </li>
                                    ))}
                                </ul>
                            </div>

                            <button
                                onClick={reset}
                                className="bg-blue-600 text-white py-3 px-8 rounded-lg font-semibold hover:bg-blue-700"
                            >
                                Generate More Documents
                            </button>
                        </div>
                    </div>
                );
            }

            if (generating) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 to-purple-700 py-12 px-4 flex items-center justify-center">
                        <div className="max-w-md mx-auto bg-white rounded-2xl shadow-2xl p-8 text-center">
                            <div className="animate-spin text-6xl mb-4">⚙️</div>
                            <h2 className="text-2xl font-bold text-gray-900 mb-4">Generating Documents...</h2>
                            <p className="text-gray-600 mb-4">{progress.message}</p>
                            <div className="w-full bg-gray-200 rounded-full h-4 mb-2">
                                <div
                                    className="bg-blue-600 h-4 rounded-full transition-all duration-500"
                                    style={{ width: `${(progress.current / progress.total) * 100}%` }}
                                ></div>
                            </div>
                            <p className="text-sm text-gray-500">
                                {progress.current} of {progress.total} documents
                            </p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50 py-12 px-4">
                    <div className="max-w-5xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
                            <h1 className="text-4xl font-bold text-gray-900 mb-2 text-center">Muletown Law</h1>
                            <p className="text-gray-600 text-center mb-8">Tennessee Legal Document Generator</p>

                            {/* Client Information */}
                            <div className="mb-8 p-6 bg-blue-50 rounded-lg">
                                <h2 className="text-2xl font-semibold mb-4 text-blue-900">Client Information</h2>

                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium mb-1">Client Name *</label>
                                        <input
                                            type="text"
                                            name="CLIENT_NAME"
                                            value={formData.CLIENT_NAME}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                            placeholder="John Smith"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Gender *</label>
                                        <select
                                            name="CLIENT_GENDER"
                                            value={formData.CLIENT_GENDER}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                        >
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                        </select>
                                    </div>
                                </div>

                                <div className="mb-4">
                                    <label className="block text-sm font-medium mb-1">County *</label>
                                    <select
                                        name="CLIENT_COUNTY"
                                        value={formData.CLIENT_COUNTY}
                                        onChange={handleChange}
                                        className="w-full px-3 py-2 border rounded-md"
                                    >
                                        {tennesseeCounties.map(c => <option key={c} value={c}>{c}</option>)}
                                    </select>
                                </div>

                                <div className="mb-4">
                                    <label className="flex items-center">
                                        <input
                                            type="checkbox"
                                            name="IS_COUPLE"
                                            checked={formData.IS_COUPLE}
                                            onChange={handleChange}
                                            className="mr-2 h-4 w-4"
                                        />
                                        <span className="font-medium">Generate documents for spouse as well</span>
                                    </label>
                                </div>

                                {formData.IS_COUPLE && (
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-4 bg-white rounded-md">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Spouse Name *</label>
                                            <input
                                                type="text"
                                                name="SPOUSE_NAME"
                                                value={formData.SPOUSE_NAME}
                                                onChange={handleChange}
                                                className="w-full px-3 py-2 border rounded-md"
                                                placeholder="Jane Smith"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Spouse Gender *</label>
                                            <select
                                                name="SPOUSE_GENDER"
                                                value={formData.SPOUSE_GENDER}
                                                onChange={handleChange}
                                                className="w-full px-3 py-2 border rounded-md"
                                            >
                                                <option value="Male">Male</option>
                                                <option value="Female">Female</option>
                                            </select>
                                        </div>
                                        <div className="md:col-span-2">
                                            <label className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    name="SPOUSE_AGENTS_RECIPROCAL"
                                                    checked={formData.SPOUSE_AGENTS_RECIPROCAL}
                                                    onChange={handleChange}
                                                    className="mr-2 h-4 w-4"
                                                />
                                                <span className="text-sm">Reciprocal (Spouse's executor/agent is Client)</span>
                                            </label>
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Executor/Agent Information */}
                            <div className="mb-8 p-6 bg-purple-50 rounded-lg">
                                <h2 className="text-2xl font-semibold mb-2 text-purple-900">Executor / Agent</h2>
                                <p className="text-sm text-gray-600 mb-4">
                                    This person will serve as Executor (Will), Agent (POA), and Healthcare Agent (HCPOA/ACP)
                                </p>

                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium mb-1">Full Name *</label>
                                        <input
                                            type="text"
                                            name="FIDUCIARY_NAME"
                                            value={formData.FIDUCIARY_NAME}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                            placeholder="Jane Smith"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Relationship *</label>
                                        <input
                                            type="text"
                                            name="FIDUCIARY_RELATIONSHIP"
                                            value={formData.FIDUCIARY_RELATIONSHIP}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                            placeholder="spouse, child, etc."
                                        />
                                    </div>
                                </div>

                                <div className="mb-6">
                                    <label className="block text-sm font-medium mb-1">County</label>
                                    <select
                                        name="FIDUCIARY_COUNTY"
                                        value={formData.FIDUCIARY_COUNTY}
                                        onChange={handleChange}
                                        className="w-full px-3 py-2 border rounded-md"
                                    >
                                        {tennesseeCounties.map(c => <option key={c} value={c}>{c}</option>)}
                                    </select>
                                </div>

                                <h3 className="text-lg font-semibold mb-2">Alternate Executor / Agent</h3>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium mb-1">Full Name *</label>
                                        <input
                                            type="text"
                                            name="ALTERNATE_FIDUCIARY_NAME"
                                            value={formData.ALTERNATE_FIDUCIARY_NAME}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                            placeholder="John Doe"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Relationship *</label>
                                        <input
                                            type="text"
                                            name="ALTERNATE_FIDUCIARY_RELATIONSHIP"
                                            value={formData.ALTERNATE_FIDUCIARY_RELATIONSHIP}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                            placeholder="child, sibling, etc."
                                        />
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium mb-1">County</label>
                                    <select
                                        name="ALTERNATE_FIDUCIARY_COUNTY"
                                        value={formData.ALTERNATE_FIDUCIARY_COUNTY}
                                        onChange={handleChange}
                                        className="w-full px-3 py-2 border rounded-md"
                                    >
                                        {tennesseeCounties.map(c => <option key={c} value={c}>{c}</option>)}
                                    </select>
                                </div>
                            </div>

                            {/* Children (for Will) */}
                            {selectedDocs.will && (
                                <div className="mb-8 p-6 bg-green-50 rounded-lg">
                                    <h2 className="text-2xl font-semibold mb-4 text-green-900">Children (for Will)</h2>

                                    {formData.children.map((child, idx) => (
                                        <div key={idx} className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 p-4 bg-white rounded-md">
                                            <div className="md:col-span-2">
                                                <label className="block text-sm font-medium mb-1">Child Name</label>
                                                <input
                                                    type="text"
                                                    value={child.name}
                                                    onChange={(e) => updateChild(idx, 'name', e.target.value)}
                                                    className="w-full px-3 py-2 border rounded-md"
                                                    placeholder="Child's full name"
                                                />
                                            </div>
                                            <div className="flex items-end gap-2">
                                                <div className="flex-1">
                                                    <label className="block text-sm font-medium mb-1">Date of Birth</label>
                                                    <input
                                                        type="date"
                                                        value={child.dob}
                                                        onChange={(e) => updateChild(idx, 'dob', e.target.value)}
                                                        className="w-full px-3 py-2 border rounded-md"
                                                    />
                                                </div>
                                                <button
                                                    onClick={() => removeChild(idx)}
                                                    className="px-3 py-2 bg-red-100 text-red-600 rounded-md hover:bg-red-200"
                                                >
                                                    Remove
                                                </button>
                                            </div>
                                        </div>
                                    ))}

                                    <button
                                        onClick={addChild}
                                        className="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"
                                    >
                                        + Add Child
                                    </button>

                                    {formData.children.length > 0 && (
                                        <div className="mt-4 p-4 bg-white rounded-md">
                                            <label className="block text-sm font-medium mb-1">Trustee for Minor Children (defaults to Executor)</label>
                                            <input
                                                type="text"
                                                name="TRUSTEE_NAME"
                                                value={formData.TRUSTEE_NAME}
                                                onChange={handleChange}
                                                className="w-full px-3 py-2 border rounded-md"
                                                placeholder={formData.FIDUCIARY_NAME || "Same as Executor"}
                                            />
                                        </div>
                                    )}

                                    <div className="mt-4 p-4 bg-white rounded-md">
                                        <label className="block text-sm font-medium mb-2">Contingent Beneficiary (if all children predecease)</label>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <input
                                                type="text"
                                                name="CONTINGENT_BENEFICIARY_NAME"
                                                value={formData.CONTINGENT_BENEFICIARY_NAME}
                                                onChange={handleChange}
                                                className="w-full px-3 py-2 border rounded-md"
                                                placeholder="Name"
                                            />
                                            <input
                                                type="text"
                                                name="CONTINGENT_BENEFICIARY_RELATION"
                                                value={formData.CONTINGENT_BENEFICIARY_RELATION}
                                                onChange={handleChange}
                                                className="w-full px-3 py-2 border rounded-md"
                                                placeholder="Relationship"
                                            />
                                        </div>
                                    </div>

                                    {/* Optional Will Clauses */}
                                    <div className="mt-4 p-4 bg-white rounded-md">
                                        <h3 className="font-semibold mb-2">Optional Will Provisions</h3>
                                        <div className="space-y-2">
                                            <label className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    name="INCLUDE_HANDWRITTEN_LIST"
                                                    checked={formData.INCLUDE_HANDWRITTEN_LIST}
                                                    onChange={handleChange}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">Include Handwritten List provision</span>
                                            </label>
                                            <label className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    name="INCLUDE_REAL_ESTATE_DEBT"
                                                    checked={formData.INCLUDE_REAL_ESTATE_DEBT}
                                                    onChange={handleChange}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">Include Real Estate Debt provision</span>
                                            </label>
                                            <label className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    name="INCLUDE_NO_CONTEST"
                                                    checked={formData.INCLUDE_NO_CONTEST}
                                                    onChange={handleChange}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">Include No Contest clause</span>
                                            </label>
                                            <label className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    name="INCLUDE_DISINHERITANCE"
                                                    checked={formData.INCLUDE_DISINHERITANCE}
                                                    onChange={handleChange}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">Include Disinheritance clause</span>
                                            </label>
                                            {formData.INCLUDE_DISINHERITANCE && (
                                                <div className="ml-6 mt-2 grid grid-cols-2 gap-2">
                                                    <input
                                                        type="text"
                                                        name="DISINHERITED_NAME"
                                                        value={formData.DISINHERITED_NAME}
                                                        onChange={handleChange}
                                                        className="px-3 py-2 border rounded-md text-sm"
                                                        placeholder="Name of person"
                                                    />
                                                    <input
                                                        type="text"
                                                        name="DISINHERITED_RELATION"
                                                        value={formData.DISINHERITED_RELATION}
                                                        onChange={handleChange}
                                                        className="px-3 py-2 border rounded-md text-sm"
                                                        placeholder="Relationship"
                                                    />
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Execution Date */}
                            <div className="mb-8 p-6 bg-gray-100 rounded-lg">
                                <h2 className="text-2xl font-semibold mb-4">Execution Date</h2>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Month</label>
                                        <select
                                            name="EXEC_MONTH"
                                            value={formData.EXEC_MONTH}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                        >
                                            {monthNames.map(m => <option key={m} value={m}>{m}</option>)}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Year</label>
                                        <input
                                            type="text"
                                            name="EXEC_YEAR"
                                            value={formData.EXEC_YEAR}
                                            onChange={handleChange}
                                            className="w-full px-3 py-2 border rounded-md"
                                        />
                                    </div>
                                </div>
                            </div>

                            {/* Document Selection */}
                            <div className="mb-8 p-6 bg-yellow-50 rounded-lg">
                                <h2 className="text-2xl font-semibold mb-4 text-yellow-900">Select Documents to Generate</h2>
                                <div className="space-y-3">
                                    <label className="flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-white transition">
                                        <input
                                            type="checkbox"
                                            checked={selectedDocs.will}
                                            onChange={() => handleDocSelection('will')}
                                            className="mr-3 h-5 w-5"
                                        />
                                        <div>
                                            <div className="font-semibold">Last Will & Testament</div>
                                            <div className="text-sm text-gray-600">Comprehensive will with executor, guardians, and trust provisions</div>
                                        </div>
                                    </label>

                                    <label className="flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-white transition">
                                        <input
                                            type="checkbox"
                                            checked={selectedDocs.poa}
                                            onChange={() => handleDocSelection('poa')}
                                            className="mr-3 h-5 w-5"
                                        />
                                        <div>
                                            <div className="font-semibold">Power of Attorney (Financial)</div>
                                            <div className="text-sm text-gray-600">Durable General POA for financial matters</div>
                                        </div>
                                    </label>

                                    <label className="flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-white transition">
                                        <input
                                            type="checkbox"
                                            checked={selectedDocs.hcpoa}
                                            onChange={() => handleDocSelection('hcpoa')}
                                            className="mr-3 h-5 w-5"
                                        />
                                        <div>
                                            <div className="font-semibold">Healthcare Power of Attorney</div>
                                            <div className="text-sm text-gray-600">Healthcare decision-making authority</div>
                                        </div>
                                    </label>

                                    <label className="flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-white transition">
                                        <input
                                            type="checkbox"
                                            checked={selectedDocs.acp}
                                            onChange={() => handleDocSelection('acp')}
                                            className="mr-3 h-5 w-5"
                                        />
                                        <div>
                                            <div className="font-semibold">Advance Care Plan</div>
                                            <div className="text-sm text-gray-600">End-of-life care preferences</div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            {/* Generate Button */}
                            <button
                                onClick={handleGenerateAll}
                                disabled={!formData.CLIENT_NAME || !formData.FIDUCIARY_NAME || Object.values(selectedDocs).every(v => !v)}
                                className="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 rounded-lg font-bold text-lg hover:from-blue-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed shadow-lg transition-all"
                            >
                                Generate All Selected Documents
                            </button>

                            {Object.values(selectedDocs).some(v => v) && (
                                <p className="text-center text-sm text-gray-500 mt-3">
                                    Will generate {Object.values(selectedDocs).filter(v => v).length} document type(s)
                                    {formData.IS_COUPLE && ` × 2 clients = ${Object.values(selectedDocs).filter(v => v).length * 2} total documents`}
                                </p>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<UnifiedDocumentGenerator />, document.getElementById('root'));
    </script>
</body>
</html>
